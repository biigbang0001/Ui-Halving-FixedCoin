<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>FixedCoin Halving Countdown</title>
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="https://github.com/Fixed-Blockchain/fixedcoin/blob/main/fix.png?raw=true">
  
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg,#1a1a1a 0%,#2d0a0a 50%,#1a1a1a 100%);
      color:#fff;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px
    }
    .logo{
      position:fixed;top:16px;left:16px;width:64px;height:auto;image-rendering:auto;
      pointer-events:none;user-select:none;filter:drop-shadow(0 2px 8px rgba(220,20,60,.6))
    }
    .container{
      background:rgba(30,30,30,.95);backdrop-filter:blur(10px);border-radius:20px;padding:32px;
      text-align:center;box-shadow:0 8px 32px rgba(220,20,60,.3);border:2px solid rgba(220,20,60,.3);
      max-width:1100px;width:100%
    }
    h1{
      font-size:2.6em;text-shadow:2px 2px 8px rgba(220,20,60,.8);margin-bottom:10px;
      background: linear-gradient(90deg, #dc143c, #ff6b6b);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .subtitle{
      font-size:1.1em;opacity:.85;margin-bottom:20px;color:#ff6b6b;
      font-weight:500;letter-spacing:1px
    }
    .current-info{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin:24px 0 28px
    }
    .info-card{
      background:linear-gradient(135deg,rgba(220,20,60,.15),rgba(139,0,0,.15));
      padding:16px;border-radius:14px;border:1px solid rgba(220,20,60,.3);
      transition:all .3s ease
    }
    .info-card:hover{
      transform:translateY(-3px);
      box-shadow:0 4px 16px rgba(220,20,60,.4);
      border-color:rgba(220,20,60,.6)
    }
    .info-card h3{font-size:1em;margin-bottom:8px;opacity:.9;color:#ffaaaa}
    .value{font-size:1.4em;font-weight:700;color:#dc143c}
    .value.highlight{color:#ff6b6b;animation:glow 2s infinite}
    @keyframes glow{0%,100%{text-shadow:0 0 5px rgba(220,20,60,.5)}50%{text-shadow:0 0 15px rgba(220,20,60,.9)}}
    .countdown{margin:18px 0 8px}
    .countdown h2{font-size:1.6em;margin-bottom:14px;opacity:.95;color:#ff6b6b}
    .time-display{
      display:grid;grid-template-columns:repeat(auto-fit,minmax(110px,1fr));gap:12px;margin-bottom:14px
    }
    .time-unit{
      background:linear-gradient(135deg,rgba(220,20,60,.2),rgba(139,0,0,.2));
      padding:14px;border-radius:12px;border:2px solid rgba(220,20,60,.4);
      transition:all .3s ease
    }
    .time-unit:hover{border-color:rgba(220,20,60,.7)}
    .time-number{font-size:2em;font-weight:700;display:block;color:#dc143c;text-shadow:0 0 10px rgba(220,20,60,.5)}
    .time-label{font-size:.9em;opacity:.85;color:#ffaaaa}
    .progress-bar{
      background:rgba(50,50,50,.4);height:18px;border-radius:10px;overflow:hidden;margin:16px 0;
      border:1px solid rgba(220,20,60,.3)
    }
    .progress-fill{
      background:linear-gradient(90deg,#dc143c,#ff6b6b,#dc143c);
      background-size:200% 100%;
      height:100%;border-radius:10px;transition:width .5s ease;min-width:2px;
      animation:shimmer 3s infinite
    }
    @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
    .status{
      font-size:1.05em;margin:12px 0 6px;padding:12px;border-radius:10px;
      background:rgba(34,139,34,.2);border:1px solid rgba(34,139,34,.4);
      font-weight:500
    }
    .status.warning{background:rgba(255,193,7,.15);border-color:rgba(255,193,7,.4);color:#ffc107}
    .status.urgent{
      background:rgba(220,20,60,.2);border-color:rgba(220,20,60,.6);color:#ff6b6b;
      animation:pulse 2s infinite;font-weight:700
    }
    @keyframes pulse{0%{opacity:1;transform:scale(1)}50%{opacity:.85;transform:scale(1.02)}100%{opacity:1;transform:scale(1)}}
    .links-section{
      margin-top:20px;padding:16px;background:rgba(220,20,60,.08);border-radius:15px;
      border-left:4px solid #dc143c
    }
    .links-section h3{margin-bottom:12px;font-size:1.2em;color:#ff6b6b}
    .links-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px}
    .link-card{
      background:rgba(220,20,60,.1);padding:14px;border-radius:10px;
      border:1px solid rgba(220,20,60,.3);transition:all .25s ease
    }
    .link-card:hover{
      background:rgba(220,20,60,.2);transform:translateY(-2px);
      box-shadow:0 4px 12px rgba(220,20,60,.3)
    }
    .link-card a{color:#ff6b6b;text-decoration:none;font-weight:700;display:block;margin-bottom:4px}
    .link-card a:hover{color:#dc143c}
    .link-description{font-size:.85em;opacity:.75;color:#ffcccc}
    .halving-info{
      margin-top:18px;padding:16px;background:rgba(220,20,60,.08);border-radius:15px;
      border-left:4px solid #ff6b6b
    }
    .halving-info h3{color:#ff6b6b;margin-bottom:8px}
    .halving-info p{opacity:.9}
    .error{
      color:#ff5252;background:rgba(255,82,82,.12);padding:12px;border-radius:10px;
      margin:14px 0;display:none;border:1px solid rgba(255,82,82,.3)
    }
    .last-update{font-size:.95em;opacity:.75;margin-top:14px;color:#ffaaaa}
    .fixed-badge{
      display:inline-block;background:#dc143c;color:#fff;padding:4px 12px;
      border-radius:6px;font-size:.9em;font-weight:700;margin-left:8px;
      box-shadow:0 2px 8px rgba(220,20,60,.5)
    }
    @media (max-width:600px){
      .links-grid{grid-template-columns:1fr}
      .logo{width:48px}
      h1{font-size:2em}
    }
  </style>
</head>
<body>
  <img class="logo" src="https://github.com/Fixed-Blockchain/fixedcoin/blob/main/fix.png?raw=true" alt="FIX"/>

  <div class="container">
    <h1>üîí FixedCoin Halving Countdown</h1>
    <div class="subtitle">Ultra-Rare ‚Ä¢ 10,000 FIX Supply <span class="fixed-badge">FIXED</span></div>

    <div class="current-info">
      <div class="info-card">
        <h3>Current Block</h3>
        <div class="value" id="currentBlock">-</div>
      </div>
      <div class="info-card">
        <h3>Next Halving Block</h3>
        <div class="value" id="nextHalvingBlock">-</div>
      </div>
      <div class="info-card">
        <h3>Current Reward</h3>
        <div class="value" id="currentReward">-</div>
      </div>
      <div class="info-card">
        <h3>Next Reward</h3>
        <div class="value" id="nextReward">-</div>
      </div>
      <div class="info-card">
        <h3>Network Difficulty</h3>
        <div class="value" id="difficulty">-</div>
      </div>
      <div class="info-card">
        <h3>Circulating Supply</h3>
        <div class="value" id="supply">-</div>
      </div>
      <div class="info-card">
        <h3>Network Hashrate</h3>
        <div class="value" id="hashrate">-</div>
      </div>
      <div class="info-card">
        <h3>Avg Blocks per 24h</h3>
        <div class="value highlight" id="avgBlocks24h">-</div>
      </div>
    </div>

    <div class="countdown">
      <h2>‚è±Ô∏è Estimated Time to Halving</h2>
      <div class="time-display">
        <div class="time-unit">
          <span class="time-number" id="days">0</span>
          <span class="time-label">Days</span>
        </div>
        <div class="time-unit">
          <span class="time-number" id="hours">0</span>
          <span class="time-label">Hours</span>
        </div>
        <div class="time-unit">
          <span class="time-number" id="minutes">0</span>
          <span class="time-label">Minutes</span>
        </div>
        <div class="time-unit">
          <span class="time-number" id="seconds">0</span>
          <span class="time-label">Seconds</span>
        </div>
      </div>
    </div>

    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>
    <div id="status" class="status">Updating‚Ä¶</div>

    <div class="halving-info">
      <h3>üìä Halving Information</h3>
      <p id="halvingDescription">Loading‚Ä¶</p>
    </div>

    <div class="links-section">
      <h3>üîó Useful Links</h3>
      <div class="links-grid">
        <div class="link-card">
          <a href="https://web.fixedcoin.org" target="_blank" rel="noopener noreferrer">üåê FixedCoin Official</a>
          <div class="link-description">Official website</div>
        </div>
        <div class="link-card">
          <a href="https://explorer.fixedcoin.org" target="_blank" rel="noopener noreferrer">üîç FIX Explorer</a>
          <div class="link-description">Blockchain explorer</div>
        </div>
        <div class="link-card">
          <a href="https://github.com/Fixed-Blockchain/fixedcoin" target="_blank" rel="noopener noreferrer">üíª GitHub Repository</a>
          <div class="link-description">Source code</div>
        </div>
        <div class="link-card">
          <a href="https://github.com/Fixed-Blockchain/fixedcoin/releases" target="_blank" rel="noopener noreferrer">üì¶ Downloads</a>
          <div class="link-description">Wallet releases</div>
        </div>
      </div>
    </div>

    <div class="last-update">Last update: <span id="lastUpdate">-</span></div>
    <div id="error" class="error"></div>
  </div>

  <script>
    const API_URL = '/fixedcoin_summary.php';
    const REFRESH_DEFAULT = 10000;
    const REFRESH_NEAR = 5000;

    let timer = null;
    let refresh = 0;

    let serverSkewMs = 0;
    let targetHalvingTs = 0;
    let blocksRemaining = 0;
    let progressPct = 0;
    let descText = '';

    function fmtInt(n){ return Number(Math.round(n)).toLocaleString(); }
    function el(id){ return document.getElementById(id); }

    function resched(ms){
      if (timer && refresh === ms) return;
      refresh = ms;
      if (timer) clearInterval(timer);
      timer = setInterval(fetchOnce, refresh);
    }

    async function fetchOnce(){
      try{
        const r = await fetch(API_URL + '?ts=' + Date.now(), {
          cache: 'no-store',
          headers: { 'Cache-Control': 'no-cache' }
        });
        if(!r.ok) throw new Error('HTTP ' + r.status);
        const j = await r.json();
        applyServer(j);
      }catch(e){
        showError('Connection error: ' + e.message);
      }
    }

    function applyServer(j){
      hideError();

      const srvNow = j.serverTime || j.as_of_ms || Date.now();
      serverSkewMs = Date.now() - srvNow;

      el('currentBlock').textContent     = Number(j.block).toLocaleString();
      el('nextHalvingBlock').textContent = Number(j.nextHalvingBlock).toLocaleString();
      el('currentReward').textContent    = j.currentReward + ' FIX';
      el('nextReward').textContent       = j.nextReward + ' FIX';

      el('difficulty').textContent = fmtInt(j.difficulty);
      el('supply').textContent     = fmtInt(j.supply) + ' / 10,000';
      el('hashrate').textContent   = (j.hashrate && j.hashrate.human) ? j.hashrate.human : '-';
      
      el('avgBlocks24h').textContent = j.avgBlocksPer24h ? j.avgBlocksPer24h.toFixed(1) : '-';

      blocksRemaining = j.blocksRemaining ?? Math.max(0, (j.nextHalvingBlock||0) - (j.block||0));
      progressPct     = Math.max(0, Math.min(100, j.progressPct ?? 0));
      targetHalvingTs = j.targetHalvingTs || 0;

      el('progressFill').style.width = progressPct + '%';

      if (blocksRemaining <= 0){
        el('status').className = 'status';
        el('status').textContent = 'üéâ Halving complete! Updating‚Ä¶';
        resched(REFRESH_DEFAULT);
      } else if (blocksRemaining <= 10){
        el('status').className = 'status urgent';
        el('status').textContent = '‚ö° URGENT: Only ' + blocksRemaining + ' blocks remaining!';
        resched(REFRESH_NEAR);
      } else if (blocksRemaining <= 100){
        el('status').className = 'status warning';
        el('status').textContent = '‚ö†Ô∏è Close to halving: ' + blocksRemaining + ' blocks remaining';
        resched(REFRESH_DEFAULT);
      } else {
        el('status').className = 'status';
        el('status').textContent = '‚úÖ ' + Number(blocksRemaining).toLocaleString() + ' blocks until next halving';
        resched(REFRESH_DEFAULT);
      }

      descText = halvingDesc(j.currentReward, j.nextReward, j.nextHalvingBlock);
      el('halvingDescription').textContent = descText;

      const asOf = new Date(j.as_of_ms || j.serverTime || Date.now());
      el('lastUpdate').textContent = asOf.toLocaleTimeString();

      renderTimer();
    }

    function halvingDesc(cur, next, block){
      if (block === 4200) return 'First halving at block 4,200 (1 ‚Üí 0.5 FIX)';
      if (block === 8400) return 'Second halving at block 8,400 (0.5 ‚Üí 0.25 FIX)';
      if (block === 12600) return 'Third halving at block 12,600 (0.25 ‚Üí 0.125 FIX)';
      if (block === 16800) return 'Fourth halving at block 16,800 (0.125 ‚Üí 0.0625 FIX)';
      if (block === 21000) return 'Fifth halving at block 21,000 (0.0625 ‚Üí 0.03125 FIX)';
      if (block === 25200) return 'Sixth halving at block 25,200 (0.03125 ‚Üí 0.015625 FIX)';
      if (block === 113400) return 'Final block at 113,400 - No more rewards after this!';
      return `Next halving: ${cur} ‚Üí ${next} FIX at block ${fmtInt(block)}`;
    }

    function renderTimer(){
      if (!targetHalvingTs){ setZeros(); return; }
      const clientNow = Date.now();
      const etaMs = Math.max(0, targetHalvingTs - (clientNow - serverSkewMs));

      const totalSec = Math.floor(etaMs/1000);
      const days  = Math.floor(totalSec / 86400);
      const hours = Math.floor((totalSec % 86400) / 3600);
      const mins  = Math.floor((totalSec % 3600) / 60);
      const secs  = totalSec % 60;

      el('days').textContent = days;
      el('hours').textContent = hours;
      el('minutes').textContent = mins;
      el('seconds').textContent = secs;
    }

    function setZeros(){
      el('days').textContent = '0';
      el('hours').textContent = '0';
      el('minutes').textContent = '0';
      el('seconds').textContent = '0';
    }

    function showError(msg){
      const e = el('error'); e.textContent = msg; e.style.display = 'block';
    }
    function hideError(){ el('error').style.display = 'none'; }

    (function init(){
      fetchOnce();
      setInterval(renderTimer, 1000);
      resched(REFRESH_DEFAULT);
      window.addEventListener('focus', fetchOnce);
      window.addEventListener('online', fetchOnce);
    })();
  </script>
</body>
</html>
